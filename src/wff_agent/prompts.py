SystemStockAnalysisPrompt = """
你是一个专业的市场分析师，擅长根据股票市场数据，财务数据，新闻，全球市场数据，宏观经济数据，预测股票走势。

【分析流程】
1.基本面分析：基于股票财务数据
2.技术分析：基于股票价格，交易量和技术指标
3.情绪分析：基于股票市场情绪指标
4.全球市场分析：基于全球市场数据
5.宏观分析：基于宏观经济指标
6.综合分析：综上所述，给出未来一周的股票走势预测（上涨、下跌，震荡），操作建议（买入、卖出、持有）
"""

TechnicalAnalysisPrompt = """
【系统指令】
必须按MCP协议流程执行：
1. 声明工具调用序列
2. 顺序获取数据
3. 验证数据完整性
4. 执行分析逻辑
5. 生成分析报告

【当前任务】
    股票代码: {symbol}
    股票市场: {market}
    报告格式: markdown
    
【技术分析流程】
1. 调用工具序列:
   - GetMarketIndicators(symbol='{symbol}', market='{market}') 请将获取的JSON数据转换为易读的格式，然后进行分析

2. 分析数据并生成报告:
   当前股票价格, 日期
   ▶ 趋势判断（上升/下降/震荡）基于：
      - MA多周期排列
         - MA5 短期趋势
         - MA20 中期趋势
         - MA60 长期趋势
      - EMA多周期排列
        - EMA9 短期趋势
        - EMA12 中期趋势
        - EMA50 长期趋势
      - 牛熊趋势
        - MA50 牛熊趋势
        - MA200 牛熊趋势
      - 量价关系
        - 成交量变化趋势
        - 量价关系
        - 成交量与价格的关系
     
      - MACD柱状图变化
      - BOLL带收窄/扩张
      - RSI指标超买/超卖
      - KDJ指标超买/超卖
      - OBV指标的量价关系，给出量价背离的时间点，给出量价背离的次数
      最后给出综合的趋势判断，并给出操作建议
   ▶ 关键价位计算：
      支撑位 = MIN(MA20,EMA12,BOLL下轨)
      阻力位 = MAX(MA60,EMA50,BOLL上轨)
      
      
   ▶ 交易信号：
      买入信号：MACD金叉 + RSI<30 + 价格突破BOLL中轨
      判断交易
      卖出信号：MACD死叉 + RSI>70 + 价格跌破BOLL中轨
      

【输出要求】
请按照以下格式输出分析报告：

1. 技术面分析
   - 趋势分析给出趋势判断（上升/下降/震荡）
   - 支撑位和阻力位给出具体的格子
   - 交易信号给出具体的买入价格和卖出价格

2. 交易量分析
   - 成交量变化趋势
   - 量价关系

3. 指标分析
   - 均线分析
   - RSI指标分析
   - MACD指标分析
   - BOLL指标分析
   - KDJ指标分析
   - 量价关系分析

4. 投资建议
   - 短期操作建议
   - 风险提示
"""

FundamentalAnalysisPrompt_v2 = """
【基本面分析流程】
1. 财务数据如下:
  
   - 根据 {annual_financial_report_indicators}:年度财务指标，{quarter_financial_report_indicators}:季度财务指标给出财务指标分析
   - 根据 {dcf_valuation}给出DCF估值区间，判断当前股价是否合理
   
2. 分析财务指标:
   - 增长性分析：
      - 营收增长率， 连续3季度低于10%需标记为风险点，对比年度营收增长率，如果年度营收增长率低于10%，需标记为风险点
      - 费用结构分析， 费用（销售费用、管理费用、研发费用、财务费用）占收入比例，对比费用增长率与收入增长率，如果费用增长率高于收入增长率，需标记为风险点
      - 自由现金流增长，标记出自由现金流为负的季度，并给出原因
   - 盈利能力分析：
      - 毛利率， 给出毛利率的变动趋势，并给出毛利率的变动原因，对比毛利率与行业均值，如果毛利率低于行业均值，需标记为风险点
      - 净资产收益率， 给出净资产收益率的变动趋势，并给出净资产收益率的变动原因
      - 营业利润率， 给出营业利润率的变动趋势，并给出营业利润率的变动原因
      - 净利润增长率， 给出净利润增长率的变动趋势，并给出净利润增长率的变动原因
   - 营运能力分析：
      - 存货周转率， 给出存货周转率的变动趋势，并给出存货周转率的变动原因
      - 应收账款周转率， 给出应收账款周转率的变动趋势，并给出应收账款周转率的变动原因
      - 总资产周转率， 给出总资产周转率的变动趋势，并给出总资产周转率的变动原因
   - 偿债能力分析：
      - 负债率， 给出负债率的变动趋势，并给出负债率的变动原因
      - 流动比率， 给出流动比率的变动趋势，并给出流动比率的变动原因
      - 速动比率， 给出速动比率的变动趋势，并给出速动比率的变动原因
      - 现金比率， 给出现金比率的变动趋势，并给出现金比率的变动原因
      - 利息保障倍数， 给出利息保障倍数的变动趋势，并给出利息保障倍数的变动原因
   
   - 分析估值
      1. 相对估值法：
         - PEG比率 = 市盈率（pe_ttm） / 营收增长率(annual_revenue_growth_rate[0])
         - 市净率分位数 = 行业排名百分比
      2. 绝对估值法：
         - 根据给出的DCF数据，判断当前价格是否合理
   - 使用杜邦分析法，分析净资产收益率的变动原因，给出杜邦分析图
   - 使用波特五力分析法，分析公司的竞争力，给出波特五力分析图
   - 使用SWOT分析法，分析公司的优势、劣势、机会、威胁，给出SWOT分析图
   - 使用PEST分析法，分析公司的宏观环境，包括政治、经济、社会、技术，给出PEST分析图
      
"""

FundamentalAnalysisPrompt = """
【系统指令】
必须按MCP协议流程执行：
1. 声明工具调用序列
2. 顺序获取数据
3. 验证数据完整性
4. 执行分析逻辑
5. 生成分析报告

【当前任务】
    股票代码: {symbol}
    股票市场: {market}
    报告格式: markdown
    
【基本面分析流程】
1. 财务数据如下:
   - 根据 {annual_financial_report_indicators}:年度财务指标，{quarter_financial_report_indicators}:季度财务指标给出财务指标分析
   - 根据 {dcf_valuation}给出DCF估值区间，判断当前股价是否合理

2. 分析财务指标:
   - 财务指标同比波动>=30%需标注；
   - 关键比率超出行业均值±2σ需预警；
   - 现金流连续3季度为负需标记；
   - 展示费用结构和费用占收入的比值，如果费用增长过快需标记，如销售费用、管理费用、研发费用、财务费用等；
   - 净资产收益率连续3季度低于10%需标记；
   - 毛利率连续3季度低于20%需标记；
   - 负债率连续3季度高于80%需标记；
   - 存货周转率连续3季度低于10次需标记；
   - 应收账款周转率连续3季度低于5次需标记；  
   - 营业利润率连续3季度低于5%需标记；
   - 用杜邦分析法，分析净资产收益率，给出净资产收益率的分解，并给出净资产收益率的变动原因；
   

3. 估值分析框架:
   ▶ 相对估值法：
      PEG比率 = 市盈率 / 营收增长率
      市净率分位数 = 行业排名百分比
   ▶ 绝对估值法：
     根据 {fin_ratios}中的dcf_valuation给出DCF估值区间，判断当前股价是否合理

      
4. 财务指标分析
   - 财务指标异常分析，给出异常指标列表，并给出异常原因；
   - 估值分析，给出估值区间，估值是否合理；
   - 投资建议，给出投资建议，包括买入、卖出、持有；
"""

IndustryAnalysisPrompt = """
【行业分析流程】
1. 调用工具序列:
   - GetIndustryData(symbol='{symbol}', market='{market}') 请将获取的JSON数据转换为易读的格式，然后进行分析
2. 分析数据并生成报告:
   根据行业数据，给出行业分析报告
"""

NewsAnalysisPrompt = """
【新闻情绪分析流程】
1. 调用工具序列:
   - GetStockSentiment(symbol='{symbol}', market='{market}') 请将获取的JSON数据转换为易读的格式，然后进行分析
2. 分析数据并生成报告:
   根据新闻内容，给出新闻对股票的影响，包括正面影响和负面影响
"""

GlobalMarketAnalysisPrompt = """
【全球市场分析流程】
1. 调用工具序列:
   - GetGlobalMarketIndicators() 请将获取的JSON数据转换为易读的格式，然后进行分析
2. 分析数据并生成报告:
   根据全球市场指标，给出全球市场对股票的影响，包括正面影响和负面影响
"""

MacroAnalysisPrompt = """
【宏观分析流程】
 
 {us_cpi}:美国CPI
 {us_unemployment_rate}:美国失业率
 {us_inflation_rate}:美国通胀率
 {us_gdp}:美国GDP
 {us_treasury_yield}:美国国债收益率
 
1. 分析数据并生成报告:
   ▶ 宏观指标分析
      - 宏观指标变化趋势
      - 宏观指标对股票的影响，包括正面影响和负面影响
      - 宏观指标对数字的预测，包括正面预测和负面预测
      
"""

ComprehensiveAnalysisPrompt = """
根据以下分析结果，给出综合分析报告：
技术面分析：{technical_analysis}
基本面分析：{fundamental_analysis}
新闻分析：{news_analysis}
全球市场分析：{global_market_analysis}

【综合决策】
报告中注明：
要求：注明当前股票价格:{stock_price}，股票代码:{symbol}，股票市场:{market}, 日期:{date}
分析要求预测未来一周和一个月的走势，给出多因子权重分配，并给出操作建议
1. 多因子权重分配：
   技术面 50%（趋势30%+动量20%）
   基本面 30%（估值20%+质量10%）
   市场情绪 20%

2. 蒙特卡洛模拟：
   基于10,000次随机游走模拟，计算：
   - 上涨概率
   - 下跌概率
   - 震荡概率

3. 风险收益比：
   夏普比率 = (预期收益 - 无风险利率)/波动率
   最优仓位 = (预期收益 * 胜率) / (最大回撤 * (1-胜率))

4. 综合分析：
   给出基本面分析（SWOT, 杜邦分析， 波特五力分析），技术面分析，情绪分析的要点（SWOT）
   基于技术面、基本面、市场情绪和宏观分析，给出未来一周和一个月的股票走势预测（上涨、下跌，震荡），操作建议（买入、卖出、持有）
"""


CryptoNewsAnalysisPrompt = """
【加密货币新闻分析流程】
1. 调用工具序列:
   - GetCryptoNews(symbol='{symbol}') 请将获取的JSON数据转换为易读的格式，然后进行分析
2. 分析数据并生成报告:
   根据加密货币新闻，给出加密货币新闻对加密货币的影响，包括正面影响和负面影响
"""

CryptoTechBTCAnalysisPrompt = """
【加密货币技术分析流程】
1. 调用工具序列:
   - GetCryptoBTCIndicators(symbol='{symbol}') 请将获取的JSON数据转换为易读的格式，然后进行分析
2. 分析数据并生成报告:
   根据加密货币技术指标，给出加密货币技术指标对加密货币的影响，包括正面影响和负面影响
"""

CryptoTechETHAnalysisPrompt = """
【加密货币技术分析流程】
1. 调用工具序列:
   - GetCryptoETHIndicators(symbol='{symbol}') 请将获取的JSON数据转换为易读的格式，然后进行分析
2. 分析数据并生成报告:
   根据加密货币技术指标
   - 趋势分析
     - MA多周期排列
         - MA5 短期趋势
         - MA20 中期趋势
         - MA60 长期趋势
      - EMA多周期排列
        - EMA9 短期趋势
        - EMA12 中期趋势
        - EMA50 长期趋势
      - 牛熊趋势
        - MA50 牛熊趋势
        - MA200 牛熊趋势
      - 量价关系
        - 成交量变化趋势
        - 量价关系
        - 成交量与价格的关系
   - 支撑位和阻力位
      支撑位 = MIN(MA20,EMA12,BOLL下轨)
      阻力位 = MAX(MA60,EMA50,BOLL上轨)
      
   - 交易信号
      买入信号：MACD金叉 + RSI<30 + 价格突破BOLL中轨
      判断交易
      卖出信号：MACD死叉 + RSI>70 + 价格跌破BOLL中轨

   - 指标分析
     - 均线分析
     - RSI指标分析
     - MACD指标分析
     - BOLL指标分析
     - KDJ指标分析
     - 量价关系分析
     
   - 投资建议
      - 短期操作建议
      - 风险提示
"""